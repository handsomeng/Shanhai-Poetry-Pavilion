# 诗歌详情页交互优化 - 原型设计

## 🎯 优化范围说明

**本次优化目标：** 只优化【诗歌详情页】（查看已写完的诗时的操作）

**不涉及改动：** 写诗页面（写诗时的交互保持不变）

---

## 📱 交互流程

### 流程 1：写诗 → 保存（保持现有交互，不改动）
```
┌─────────────────────────────────────┐
│  [取消]         写诗页面    [保存]   │ ←保存按钮在右上角
├─────────────────────────────────────┤
│                                     │
│  [标题输入框]                        │
│                                     │
│  [正文输入区域]                      │
│                                     │
│                                     │
│                                     │
│                                     │
└─────────────────────────────────────┘
              ↓ 点击保存
         直接保存成功
              ↓
         返回诗集列表
              ↓
         新诗显示在列表顶部（高亮）

✅ 此流程保持不变，不做任何修改
```

### 流程 2：查看诗歌详情 → 操作菜单
```
诗集列表
   ↓ 点击某首诗
诗歌详情页（默认状态：只读）
   ↓ 点击右上角 ⋯
弹出操作菜单
   ├─ 分享 → 呼出分享界面（待开发）
   ├─ 编辑 → 进入编辑状态
   ├─ 复制 → 复制标题+正文到剪贴板
   └─ 删除 → 弹出删除确认弹窗
```

---

## 🎨 界面原型

### 1. 诗歌详情页（默认状态：只读）

```
┌─────────────────────────────────────┐
│  ← 返回              [⋯] ←三个点按钮 │
├─────────────────────────────────────┤
│                                     │
│                                     │
│          【诗歌标题】                │
│                                     │
│                                     │
│     诗歌正文内容                     │
│     第一行                           │
│     第二行                           │
│     第三行                           │
│     ...                             │
│                                     │
│                                     │
│                                     │
│  ─────────────────────────          │
│  第 3 首诗                           │
│  诗人 · 李白                         │
│  2024年1月15日                       │
│                                     │
└─────────────────────────────────────┘
```

**特点：**
- ✅ 纯展示模式，不可编辑
- ✅ 只有一个操作入口：右上角 [⋯] 按钮
- ✅ 界面简洁优雅

---

### 2. 点击 [⋯] 后弹出操作菜单

```
┌─────────────────────────────────────┐
│  ← 返回              [⋯] ←点击后     │
│                        ┌──────────┐ │
│                        │ 📤 分享  │ │
│          【诗歌标题】   │ ✏️ 编辑  │ │
│                        │ 📋 复制  │ │
│                        │ 🗑️ 删除  │ │
│     诗歌正文内容        └──────────┘ │
│     第一行                           │
│     第二行                           │
│     第三行                           │
│     ...                             │
│                                     │
└─────────────────────────────────────┘
```

**菜单设计：**
- **位置**：从右上角 [⋯] 按钮向下弹出
- **样式**：白色卡片，轻微阴影，圆角
- **每项结构**：图标 + 文字（左对齐）
- **点击外部**：菜单消失

---

### 3. 菜单详细设计

```
┌─────────────────────┐
│  📤  分享           │ ← 呼出分享界面（待开发）
├─────────────────────┤
│  ✏️  编辑           │ ← 诗歌变为可编辑状态
├─────────────────────┤
│  📋  复制           │ ← 复制标题+正文，显示 Toast
├─────────────────────┤
│  🗑️  删除           │ ← 弹出删除确认弹窗（红色文字）
└─────────────────────┘
```

**样式规范：**
- **宽度**：160pt
- **每项高度**：48pt
- **图标大小**：20pt
- **文字大小**：16pt，中等字重
- **颜色**：
  - 图标和文字：`Colors.textInk`
  - 删除项文字：`Colors.accentRed`
- **分割线**：1px，`Colors.divider`
- **阴影**：`shadow(color: .black.opacity(0.1), radius: 12, x: 0, y: 4)`

---

### 4. 点击"编辑"后的效果

```
┌─────────────────────────────────────┐
│  [取消]              [完成] ←编辑模式│
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 【诗歌标题】                 │   │ ← 可编辑
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 诗歌正文内容                 │   │
│  │ 第一行                       │   │ ← 可编辑
│  │ 第二行                       │   │
│  │ 第三行                       │   │
│  │ ...                         │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

**编辑模式：**
- ✅ 标题和正文变为可编辑状态
- ✅ 左上角：[取消] 按钮（放弃修改）
- ✅ 右上角：[完成] 按钮（保存修改）
- ✅ 底部信息隐藏

---

### 5. 点击"删除"后的确认弹窗

```
┌─────────────────────────────────────┐
│                                     │
│         ┌─────────────────┐         │
│         │                 │         │
│         │   删除这首诗？   │         │
│         │                 │         │
│         │ 删除后无法恢复   │         │
│         │                 │         │
│         │  ┌───────────┐  │         │
│         │  │   取消     │  │         │
│         │  └───────────┘  │         │
│         │  ┌───────────┐  │         │
│         │  │   删除     │  │ ←红色   │
│         │  └───────────┘  │         │
│         │                 │         │
│         └─────────────────┘         │
│                                     │
└─────────────────────────────────────┘
```

**确认弹窗样式：**
- **标题**：18pt，中等字重，`Colors.textInk`
- **描述**：14pt，常规字重，`Colors.textSecondary`
- **取消按钮**：次要按钮样式（灰色边框）
- **删除按钮**：主要按钮样式（红色背景）

---

### 6. 点击"复制"后的效果

```
┌─────────────────────────────────────┐
│  ← 返回              [⋯]            │
├─────────────────────────────────────┤
│                                     │
│          ┌─────────────────┐        │
│          │  ✅ 已复制      │ ←Toast │
│          └─────────────────┘        │
│                                     │
│          【诗歌标题】                │
│                                     │
│     诗歌正文内容                     │
│     ...                             │
│                                     │
└─────────────────────────────────────┘
```

**复制内容格式：**
```
【诗歌标题】

诗歌正文
第一行
第二行
第三行
```

**Toast 样式：**
- **位置**：屏幕中上部
- **背景**：半透明黑色
- **文字**：白色
- **显示时长**：1.5秒

---

## 🎯 交互细节

### 操作菜单（Menu）

| 操作项 | 交互行为 | 反馈 |
|--------|----------|------|
| **分享** | 呼出分享界面（待开发） | 关闭菜单 → 打开分享界面 |
| **编辑** | 进入编辑模式 | 关闭菜单 → 界面变为可编辑 |
| **复制** | 复制标题+正文到剪贴板 | 关闭菜单 → 显示"已复制"Toast |
| **删除** | 弹出删除确认弹窗 | 关闭菜单 → 显示确认弹窗 |

### 编辑模式

| 按钮 | 行为 |
|------|------|
| **取消** | 放弃修改，返回只读模式 |
| **完成** | 保存修改，返回只读模式，显示"保存成功"Toast |

---

## 📊 对比：优化前 vs 优化后

### 优化前（ShareSheet）
```
诗歌详情页
   ↓ 点击右上角"分享"按钮
弹出 ShareSheet（全屏）
   ├─ 生成图片
   ├─ AI 点评
   └─ （感觉功能臃肿）
```

**问题：**
- ❌ 功能混杂：分享 + 编辑 + AI 点评
- ❌ 入口不清晰：分享按钮承担太多功能
- ❌ 界面臃肿：全屏弹窗

### 优化后（操作菜单）
```
诗歌详情页
   ↓ 点击右上角 [⋯]
弹出操作菜单（轻量级）
   ├─ 分享（独立功能）
   ├─ 编辑（独立功能）
   ├─ 复制（独立功能）
   └─ 删除（独立功能）
```

**优势：**
- ✅ 功能清晰：每个操作独立
- ✅ 入口统一：[⋯] 是常见的操作入口
- ✅ 界面轻量：下拉菜单，不打断阅读
- ✅ 符合直觉：参考 iOS 备忘录、Flomo

---

## 🚀 实施计划

### Phase 1：重构诗歌详情页（0.5天）
1. ✅ 移除右上角"分享"和"删除"按钮
2. ✅ 添加右上角 [⋯] 按钮
3. ✅ 实现下拉操作菜单组件
4. ✅ 实现"复制"功能（复制到剪贴板 + Toast）

### Phase 2：完善编辑功能（0.5天）
5. ✅ 实现"编辑"模式切换
6. ✅ 添加"取消"和"完成"按钮
7. ✅ 保存编辑后的内容

### Phase 3：完善删除功能（0.5天）
8. ✅ 实现删除确认弹窗
9. ✅ 删除成功后返回诗集列表

### Phase 4：分享功能（待定）
10. ⏸️ 设计分享界面（多模板选择等）
11. ⏸️ 实现分享功能

---

## ✅ 验收标准

### 功能验收
- ✅ 点击 [⋯] 按钮弹出菜单，点击外部关闭
- ✅ 点击"编辑"进入编辑模式，可修改标题和正文
- ✅ 点击"完成"保存修改，返回只读模式
- ✅ 点击"取消"放弃修改，返回只读模式
- ✅ 点击"复制"复制标题+正文，显示Toast
- ✅ 点击"删除"弹出确认弹窗，确认后删除并返回列表

### UI 验收
- ✅ 菜单样式符合设计规范
- ✅ 菜单位置准确（从 [⋯] 按钮下方弹出）
- ✅ Toast 样式和显示时长符合预期
- ✅ 编辑模式下标题和正文可编辑
- ✅ 删除确认弹窗样式符合预期

### 交互验收
- ✅ 所有按钮点击反馈流畅
- ✅ 菜单弹出/关闭动画自然
- ✅ 编辑模式切换流畅
- ✅ 复制成功后立即显示 Toast
- ✅ 删除确认后返回诗集列表

---

## 📝 技术实现要点

### 1. 操作菜单组件
- 使用 SwiftUI 的 `.contextMenu` 或自定义 `Menu` 组件
- 从 [⋯] 按钮位置弹出
- 半透明背景蒙层，点击关闭

### 2. 编辑模式状态管理
```swift
@State private var isEditing = false
@State private var editedTitle = ""
@State private var editedContent = ""
```

### 3. 复制功能
```swift
UIPasteboard.general.string = "\(poem.title)\n\n\(poem.content)"
```

### 4. Toast 组件
- 使用现有 `ToastManager`
- 1.5秒后自动消失

---

## 💬 待确认

1. **菜单样式**：是否使用系统原生的 `.contextMenu` 还是自定义样式？
2. **图标**：是否使用 emoji（📤✏️📋🗑️）还是 SF Symbols？
3. **分享功能**：是否在这次实现，还是后续独立开发？

请确认原型设计是否符合预期，我再开始实施！🚀

