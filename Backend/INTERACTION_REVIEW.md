# 🔍 交互流程 Review

> **目的**：全面审查交互逻辑，发现潜在问题  
> **状态**：待用户确认

---

## 📋 核心交互检查清单

### ✅ 1. 按钮命名一致性

| 场景 | 按钮名称 | 理由 |
|------|---------|------|
| 写诗页面 | **保存到诗集** | 明确操作结果 ✅ |
| 编辑诗集 | **保存** | 已在诗集，只是更新 ✅ |
| 编辑草稿 | **保存到诗集** | 草稿会移动到诗集 ✅ |

**结论**：命名清晰，逻辑合理 ✅

---

### ⚠️ 2. 编辑保存后的行为差异

**场景对比**：

#### 场景 A：写诗 → 保存到诗集
```
点击"保存到诗集"
    ↓
保存到本地诗集
    ↓
生成分享图片
    ↓
显示成功页面 ← ✅ 有
    ↓
4个按钮（AI点评/保存图片/分享/发布）
```

#### 场景 B：编辑草稿 → 保存到诗集
```
点击"保存到诗集"
    ↓
删除草稿 + 保存到诗集
    ↓
生成分享图片
    ↓
显示成功页面 ← ✅ 有
    ↓
4个按钮（AI点评/保存图片/分享/发布）
```

#### 场景 C：编辑诗集 → 保存
```
点击"保存"
    ↓
更新诗集内容
    ↓
Toast: "已保存"
    ↓
返回详情页 ← ❌ 没有成功页面
```

**问题**：
- 场景 A 和 B 显示成功页面
- 场景 C 不显示成功页面
- 是否一致？

**方案对比**：

| 方案 | 场景C行为 | 优点 | 缺点 |
|------|-----------|------|------|
| **方案1**（当前） | 直接保存 + Toast | 流畅，不繁琐 | 不统一 |
| **方案2** | 显示成功页面 + 4按钮 | 统一 | 可能繁琐 |

**我的建议**：
- 保持方案1（当前）
- 理由：
  1. 用户编辑诗集时，通常只想快速修改
  2. 如果需要分享/发布，可以从详情页操作
  3. 避免每次编辑都弹出成功页面（繁琐）

**❓ 用户确认**：
- [ ] 方案1：编辑保存直接回详情页（推荐）
- [ ] 方案2：编辑保存也显示成功页面

---

### ✅ 3. 成功页面的关闭行为

**场景**：用户点击"保存到诗集"，显示成功页面

**关闭方式**：
1. 点击"×"关闭按钮
2. 向下滑动（可选）

**关闭后去哪里**？

#### 场景 A：写诗页面 → 保存 → 成功页面 → 关闭
```
写诗页面
    ↓
点击"保存到诗集"
    ↓
成功页面（半屏弹窗）
    ↓
点击"×"关闭
    ↓
❓ 去哪里？
```

**选项**：
- **选项1**：回到写诗页面（内容还在）
- **选项2**：关闭写诗页面，回到上一级（首页/我的）

**我的建议**：选项2
- 理由：诗歌已保存，用户通常不需要再编辑
- 如果用户想继续创作，可以从首页重新进入

#### 场景 B：编辑草稿 → 保存 → 成功页面 → 关闭
```
草稿列表
    ↓
点击草稿卡片
    ↓
编辑草稿页面
    ↓
点击"保存到诗集"
    ↓
成功页面
    ↓
点击"×"关闭
    ↓
❓ 去哪里？
```

**选项**：
- **选项1**：回到草稿列表（但草稿已移动到诗集）
- **选项2**：回到"我的"页面，自动切换到诗集Tab

**我的建议**：选项2
- 理由：草稿已移动到诗集，应该让用户看到新位置

**❓ 用户确认**：
- [ ] 写诗保存后关闭 → 回到上一级
- [ ] 草稿保存后关闭 → 回到"我的"诗集Tab

---

### ⚠️ 4. 发布到广场后的按钮状态

**场景**：在成功页面点击"发布到广场"

**当前逻辑**：
```
点击"发布到广场"
    ↓
上传到云端
    ↓
按钮变为"✓ 已发布"（置灰）
    ↓
用户还在成功页面
```

**问题**：
- 用户点击"✓ 已发布"会发生什么？
- 是否需要禁用点击？
- 还是显示 Toast："该诗歌已发布到广场"？

**我的建议**：
```swift
Button("✓ 已发布到广场") {
    // 已发布，显示提示
    ToastManager.shared.show("该诗歌已发布到广场")
}
.disabled(true) // 禁用点击
.opacity(0.5)   // 视觉上置灰
```

**❓ 用户确认**：
- [ ] 按钮置灰 + 禁用点击
- [ ] 按钮置灰 + 可点击显示 Toast

---

### ✅ 5. 草稿取消的3选项弹窗

**场景**：编辑草稿时点击"取消"

**弹窗选项**：
1. **保存草稿** → 保存修改，草稿仍在草稿Tab
2. **不修改草稿** → 放弃修改，恢复原草稿
3. **继续编辑** → 关闭弹窗

**逻辑清晰度检查**：
- ✅ "保存草稿"：清晰，保存到草稿Tab
- ⚠️ "不修改草稿"：可能引起混淆

**问题**：
- "不修改草稿" vs "放弃修改"
- 哪个更清晰？

**建议**：改为"放弃修改"
```
┌────────────────────────┐
│   ⚠️ 确认退出？        │
│                        │
│  选择如何处理草稿：     │
│                        │
│  [ 保存草稿 ]          │  ← 保存修改
│  [ 放弃修改 ]          │  ← 恢复原内容
│  [ 继续编辑 ]          │  ← 继续
│                        │
└────────────────────────┘
```

**❓ 用户确认**：
- [ ] "不修改草稿"（原方案）
- [ ] "放弃修改"（更清晰）

---

### ✅ 6. 删除操作的一致性

| Tab | 删除方式 | 确认弹窗 |
|-----|---------|---------|
| 诗集 | 详情页按钮 + 左滑 | ✅ 有 |
| 草稿 | 左滑 | ✅ 有 |
| 已发布 | 无 | - |

**逻辑合理性**：
- ✅ 诗集：两种方式都支持（灵活）
- ✅ 草稿：左滑删除（快速）
- ✅ 已发布：不可删除（云端管理）

**结论**：删除操作逻辑合理 ✅

---

### ⚠️ 7. 诗集详情页的按钮布局

**当前设计**（未发布）：
```
┌────────────────────────┐
│                        │
│  [ 编辑 ]  [ 发布 ]    │
│                        │
│     [ AI 点评 ]        │
│                        │
│     [ 删除 ]           │
│                        │
└────────────────────────┘
```

**当前设计**（已发布）：
```
┌────────────────────────┐
│                        │
│  [ 编辑 ]  [✓ 已发布]  │  ← 都置灰
│                        │
│     [ AI 点评 ]        │
│                        │
│     [ 删除 ]           │
│                        │
└────────────────────────┘
```

**问题**：
- 已发布诗歌能删除本地副本吗？
- 如果能删除，删除后在"已发布"Tab还能看到吗？

**场景分析**：
```
诗集Tab的已发布诗歌
    ↓
点击"删除"
    ↓
删除本地副本（UserDefaults）
    ↓
❓ "已发布"Tab 怎么办？
```

**选项**：
- **选项1**：删除本地，"已发布"Tab 仍显示（从云端加载）
- **选项2**：删除本地，"已发布"Tab 也删除（不合理）
- **选项3**：已发布诗歌不可删除本地副本

**我的建议**：选项1
- 已发布诗歌可以删除本地副本
- "已发布"Tab 从云端加载，不受影响
- 这样用户可以清理本地空间

**❓ 用户确认**：
- [ ] 选项1：可删除本地，云端保留
- [ ] 选项3：已发布诗歌不可删除

---

### ✅ 8. 图片生成和分享的流程

**流程检查**：
```
点击"保存到诗集"
    ↓
生成诗歌图片（内存中）
    ↓
显示成功页面（显示图片）
    ↓
用户操作：
├─ 点击"保存图片" → 保存到相册
├─ 点击"分享" → 保存到临时目录 → 分享面板
└─ 点击"×" → 关闭页面（图片丢弃）
```

**逻辑清晰度**：
- ✅ 图片生成时机明确
- ✅ 图片保存时机明确
- ✅ 用户可选择是否保存

**结论**：图片流程合理 ✅

---

### ⚠️ 9. 网络相关的容错

**场景**：发布到广场时网络失败

**当前逻辑**（推测）：
```
点击"发布到广场"
    ↓
网络请求失败
    ↓
Toast: "发布失败，请重试"
    ↓
按钮恢复为"发布到广场"（可重试）
```

**问题**：
- 诗歌已保存到本地诗集
- 但未成功发布到云端
- 如何让用户知道可以稍后重试？

**建议**：
- 在诗集详情页保留"发布到广场"按钮
- 用户可以随时重新发布
- 发布成功后按钮才变为"✓ 已发布"

**❓ 用户确认**：
- [ ] 发布失败可在详情页重试
- [ ] 其他方案：__________

---

### ⚠️ 10. 边界情况：空标题

**场景**：用户写诗时没有填标题

**当前逻辑**：
- 标题为空时，默认使用"无标题"

**问题**：
- 在生成的分享图片中如何显示？
- 是否显示"无标题"？
- 还是只显示正文？

**建议**：
- 如果标题为空，分享图片不显示标题区域
- 只显示正文 + 作者 + 日期

**❓ 用户确认**：
- [ ] 空标题显示"无标题"
- [ ] 空标题不显示标题区域（推荐）

---

## 📊 总结：需要确认的问题

### 🔴 高优先级（影响开发）

1. **编辑保存行为**：
   - [ ] 方案1：编辑诗集保存后直接回详情页（推荐）
   - [ ] 方案2：编辑诗集保存后也显示成功页面

2. **成功页面关闭后去哪里**：
   - [ ] 写诗保存后 → 回到上一级（推荐）
   - [ ] 草稿保存后 → 回到"我的"诗集Tab（推荐）

3. **已发布诗歌的本地删除**：
   - [ ] 选项1：可删除本地，云端保留（推荐）
   - [ ] 选项3：已发布诗歌不可删除

### 🟡 中优先级（优化体验）

4. **发布按钮置灰后**：
   - [ ] 禁用点击
   - [ ] 可点击显示 Toast（推荐）

5. **草稿取消弹窗文案**：
   - [ ] "不修改草稿"（原方案）
   - [ ] "放弃修改"（更清晰，推荐）

### 🟢 低优先级（细节优化）

6. **发布失败后**：
   - [ ] 可在详情页重试（推荐）

7. **空标题的分享图片**：
   - [ ] 显示"无标题"
   - [ ] 不显示标题区域（推荐）

---

## ✅ 我的推荐配置

基于以上分析，我推荐以下配置：

1. **编辑保存行为**：方案1（直接回详情页）
2. **成功页面关闭**：写诗→上一级，草稿→诗集Tab
3. **已发布删除**：可删除本地，云端保留
4. **发布按钮置灰**：可点击显示 Toast
5. **草稿取消文案**："放弃修改"
6. **发布失败**：可在详情页重试
7. **空标题图片**：不显示标题区域

---

## 💬 请确认

**快速确认**：
- [ ] ✅ 全部使用推荐配置，开始开发
- [ ] ❌ 需要调整：（请说明哪几项）

**详细确认**：
- [ ] 问题1：方案 ___
- [ ] 问题2：选项 ___
- [ ] 问题3：选项 ___
- [ ] ...

---

请告诉我你的选择，我就可以开始开发了！🚀

